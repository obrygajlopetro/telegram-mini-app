<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–í–∏—Ç—Ä–∏–Ω–∞</title>
  <style>
    body {
      margin: 0;
      background: #121212;
      color: white;
      font-family: sans-serif;
    }
    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
      background: #1e1e1e;
      border-radius: 10px;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      text-align: center;
    }
    .button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 5px;
      border: none;
      background: #444;
      color: white;
      cursor: pointer;
    }
    .loader, .order-loader {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2000;
      background: #1e1e1e;
      border-radius: 10px;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      text-align: center;
    }
    .payment-screen {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2000;
      background: #1e1e1e;
      border-radius: 10px;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      text-align: left;
    }
    .progress-container {
      width: 100%;
      background: #333;
      border-radius: 5px;
      overflow: hidden;
      height: 10px;
    }
    .progress-bar {
      width: 0;
      height: 100%;
      background: white;
    }
    .blurred > *:not(#order-loader) {
      filter: blur(6px);
      pointer-events: none;
      user-select: none;
    }
    .yellow-box {
      background: #2c1b1b;
      border: 1px solid #ab0000;
      border-radius: 8px;
      padding: 10px;
      color: #ab0000;
      margin-top: 10px;
      font-size: 14px;
    }
  </style>
</head>
<body>
<!-- –ë–ª–æ–∫ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞ –∏ –º–µ—Ç—Ä–æ -->

<div id="city-metro-modal" class="modal">
  <img src="https://i.ibb.co/qLzdxJpc/B512.png" alt="–ë–∞–Ω–Ω–µ—Ä" style="max-width:100%;height:auto;object-fit:contain;margin-bottom:10px;">
    <select id="city-select" style="width:100%;padding:10px;margin:10px 0;border-radius:5px;border:none;background:#333;color:white;">
    <option value="moscow">–ú–æ—Å–∫–≤–∞</option>
    <option value="spb">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
  </select>
  <select id="metro-select" style="width:100%;padding:10px;margin:10px 0;border-radius:5px;border:none;background:#333;color:white;"></select>
  <button id="confirm-btn" class="button">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
</div>

<!-- –õ–æ–∞–¥–±–∞—Ä -->
<div id="loader" class="loader" style="display:none;">
  <p id="loader-text">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏—Ç—Ä–∏–Ω—ã...</p>
  <div class="progress-container">
    <div id="progress-bar" class="progress-bar"></div>
  </div>
</div>

<!-- –í–∏—Ç—Ä–∏–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
<div id="storefront" style="display:none; padding:20px;">
  <h2 id="store-title" style="text-align:center;">–í–∏—Ç—Ä–∏–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤</h2>
  <div id="product-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:20px;margin-top:20px;"></div>
</div>

<!-- –õ–æ–∞–¥–±–∞—Ä –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ -->
<div id="order-loader" class="order-loader" style="display:none;">
  <p id="order-loader-text">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∑–∞–∫–∞–∑—É...</p>
  <div class="progress-container">
    <div id="order-progress-bar" class="progress-bar"></div>
  </div>
</div>

<!-- –≠–∫—Ä–∞–Ω –æ–ø–ª–∞—Ç—ã -->
<div id="payment-screen" class="payment-screen" style="display:none;"></div>

<script>
  const citySelect = document.getElementById("city-select");
  const metroSelect = document.getElementById("metro-select");
  const modal = document.getElementById("city-metro-modal");
  const loader = document.getElementById("loader");
  const loaderText = document.getElementById("loader-text");
  const progressBar = document.getElementById("progress-bar");
  const storefront = document.getElementById("storefront");
  const productGrid = document.getElementById("product-grid");
  const storeTitle = document.getElementById("store-title");
  const paymentScreen = document.getElementById("payment-screen");
  let selectedMetro = "";
  let savedOrderId = null;
  let lastCheckTime = null;

  const products = [
    "–ö—Ä–∞—Å–Ω—ã–π –∫—É–±–∏–∫", "–°–∏–Ω–∏–π —à–∞—Ä", "–ñ—ë–ª—Ç—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫", "–ó–µ–ª—ë–Ω—ã–π —Ü–∏–ª–∏–Ω–¥—Ä",
    "–û—Ä–∞–Ω–∂–µ–≤–∞—è –ø–∏—Ä–∞–º–∏–¥–∞", "–°–∏—Ä–µ–Ω–µ–≤–∞—è –∑–≤–µ–∑–¥–∞", "–ë–µ–ª—ã–π –∫–æ–Ω—É—Å", "–ß—ë—Ä–Ω—ã–π –∫—É–±",
    "–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —à–∞—Ä", "–ù–µ–æ–Ω–æ–≤—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫"
  ];

  const metroStations = {
      moscow: [
        "–ê–≤–∏–∞–º–æ—Ç–æ—Ä–Ω–∞—è","–ê–≤—Ç–æ–∑–∞–≤–æ–¥—Å–∫–∞—è","–ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∞—è","–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤—Å–∫–∏–π —Å–∞–¥","–ê–ª–µ–∫—Å–µ–µ–≤—Å–∫–∞—è",
        "–ê–ª–º–∞-–ê—Ç–∏–Ω—Å–∫–∞—è","–ê–ª—Ç—É—Ñ—å–µ–≤–æ","–ê–Ω–Ω–∏–Ω–æ","–ê—Ä–±–∞—Ç—Å–∫–∞—è","–ê—ç—Ä–æ–ø–æ—Ä—Ç","–ë–∞–±—É—à–∫–∏–Ω—Å–∫–∞—è","–ë–∞—Ä—Ä–∏–∫–∞–¥–Ω–∞—è",
        "–ë–∞—É–º–∞–Ω—Å–∫–∞—è","–ë–µ–≥–æ–≤–∞—è","–ë–µ–ª–æ—Ä—É—Å—Å–∫–∞—è","–ë–µ–ª–æ–º–æ—Ä—Å–∫–∞—è","–ë–µ–ª—è–µ–≤–æ","–ë–∏–±–∏—Ä–µ–≤–æ","–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏–º. –õ–µ–Ω–∏–Ω–∞",
        "–ë–æ—Ä–æ–≤–∏—Ü–∫–∞—è","–ë–æ—Ç–∞–Ω–∏—á–µ—Å–∫–∏–π —Å–∞–¥","–ë—Ä–∞—Ç–∏—Å–ª–∞–≤—Å–∫–∞—è","–ë—É–ª—å–≤–∞—Ä –î–º–∏—Ç—Ä–∏—è –î–æ–Ω—Å–∫–æ–≥–æ","–ë—É–ª—å–≤–∞—Ä –†–æ–∫–æ—Å—Å–æ–≤—Å–∫–æ–≥–æ",
        "–ë—É–Ω–∏–Ω—Å–∫–∞—è –∞–ª–ª–µ—è","–í–∞—Ä—à–∞–≤—Å–∫–∞—è","–í–î–ù–•","–í–µ—Ä—Ö–Ω–∏–µ –ö–æ—Ç–ª—ã","–í–ª–∞–¥—ã–∫–∏–Ω–æ","–í–æ–¥–Ω—ã–π —Å—Ç–∞–¥–∏–æ–Ω","–í–æ–π–∫–æ–≤—Å–∫–∞—è",
        "–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç","–í–æ–ª–∂—Å–∫–∞—è","–í–æ–ª–æ–∫–æ–ª–∞–º—Å–∫–∞—è","–í–æ—Ä–æ–±—å—ë–≤—ã –≥–æ—Ä—ã","–í—ã—Å—Ç–∞–≤–æ—á–Ω–∞—è","–í—ã—Ö–∏–Ω–æ",
        "–î–∏–Ω–∞–º–æ","–î–º–∏—Ç—Ä–æ–≤—Å–∫–∞—è","–î–æ–±—Ä—ã–Ω–∏–Ω—Å–∫–∞—è","–î–æ–º–æ–¥–µ–¥–æ–≤—Å–∫–∞—è","–î–æ—Å—Ç–æ–µ–≤—Å–∫–∞—è","–î—É–±—Ä–æ–≤–∫–∞","–ñ—É–ª–µ–±–∏–Ω–æ",
        "–ó—è–±–ª–∏–∫–æ–≤–æ","–ò–∑–º–∞–π–ª–æ–≤—Å–∫–∞—è","–ö–∞–ª—É–∂—Å–∫–∞—è","–ö–∞–Ω—Ç–µ–º–∏—Ä–æ–≤—Å–∫–∞—è","–ö–∞—Ö–æ–≤—Å–∫–∞—è","–ö–∞—à–∏—Ä—Å–∫–∞—è","–ö–∏–µ–≤—Å–∫–∞—è",
        "–ö–∏—Ç–∞–π-–≥–æ—Ä–æ–¥","–ö–æ–∂—É—Ö–æ–≤—Å–∫–∞—è","–ö–æ–ª–æ–º–µ–Ω—Å–∫–∞—è","–ö–æ–º—Å–æ–º–æ–ª—å—Å–∫–∞—è","–ö–æ–Ω—å–∫–æ–≤–æ","–ö—Ä–∞—Å–Ω–æ–≥–≤–∞—Ä–¥–µ–π—Å–∫–∞—è",
        "–ö—Ä–∞—Å–Ω–æ–ø—Ä–µ—Å–Ω–µ–Ω—Å–∫–∞—è","–ö—Ä–∞—Å–Ω–æ—Å–µ–ª—å—Å–∫–∞—è","–ö—Ä–∞—Å–Ω—ã–µ –≤–æ—Ä–æ—Ç–∞","–ö—Ä–µ—Å—Ç—å—è–Ω—Å–∫–∞—è –∑–∞—Å—Ç–∞–≤–∞","–ö—Ä–æ–ø–æ—Ç–∫–∏–Ω—Å–∫–∞—è",
        "–ö—Ä—ã–ª–∞—Ç—Å–∫–æ–µ","–ö—É–∑–Ω–µ—Ü–∫–∏–π –º–æ—Å—Ç","–ö—É–∑—å–º–∏–Ω–∫–∏","–ö—É–Ω—Ü–µ–≤—Å–∫–∞—è","–ö—É—Ä—Å–∫–∞—è","–ö—É—Ç—É–∑–æ–≤—Å–∫–∞—è","–õ–µ–Ω–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç",
        "–õ—É–±—è–Ω–∫–∞","–õ—É–∂–Ω–∏–∫–∏","–õ—É—Ö–º–∞–Ω–æ–≤—Å–∫–∞—è","–õ—é–±–ª–∏–Ω–æ","–ú–∞—Ä–∫—Å–∏—Å—Ç—Å–∫–∞—è","–ú–∞—Ä—å–∏–Ω–∞ —Ä–æ—â–∞","–ú–∞—Ä—å–∏–Ω–æ","–ú–∞—è–∫–æ–≤—Å–∫–∞—è",
        "–ú–µ–¥–≤–µ–¥–∫–æ–≤–æ","–ú–µ–Ω–¥–µ–ª–µ–µ–≤—Å–∫–∞—è","–ú–∏—Ç–∏–Ω–æ","–ú–æ–ª–æ–¥—ë–∂–Ω–∞—è","–ù–∞–≥–∞—Ç–∏–Ω—Å–∫–∞—è","–ù–∞–≥–æ—Ä–Ω–∞—è","–ù–∞—Ö–∏–º–æ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç",
        "–ù–æ–≤–æ–≥–∏—Ä–µ–µ–≤–æ","–ù–æ–≤–æ–∫–æ—Å–∏–Ω–æ","–ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫–∞—è","–ù–æ–≤–æ—Å–ª–æ–±–æ–¥—Å–∫–∞—è","–ù–æ–≤–æ—è—Å–µ–Ω–µ–≤—Å–∫–∞—è","–û–∫—Ç—è–±—Ä—å—Å–∫–∞—è",
        "–û–∫—Ç—è–±—Ä—å—Å–∫–æ–µ –ø–æ–ª–µ","–û—Ä–µ—Ö–æ–≤–æ","–û—Ç—Ä–∞–¥–Ω–æ–µ","–û—Ö–æ—Ç–Ω—ã–π —Ä—è–¥","–ü–∞–≤–µ–ª–µ—Ü–∫–∞—è","–ü–∞—Ä–∫ –∫—É–ª—å—Ç—É—Ä—ã","–ü–∞—Ä–∫ –ü–æ–±–µ–¥—ã",
        "–ü–∞—Ä—Ç–∏–∑–∞–Ω—Å–∫–∞—è","–ü–µ—Ä–≤–æ–º–∞–π—Å–∫–∞—è","–ü–µ—Ä–æ–≤–æ","–ü–µ—Ç—Ä–æ–≤—Å–∫–æ-–†–∞–∑—É–º–æ–≤—Å–∫–∞—è","–ü–µ—á–∞—Ç–Ω–∏–∫–∏","–ü–∏–æ–Ω–µ—Ä—Å–∫–∞—è","–ü–ª–∞–Ω–µ—Ä–Ω–∞—è",
        "–ü–ª–æ—â–∞–¥—å –ò–ª—å–∏—á–∞","–ü–ª–æ—â–∞–¥—å –†–µ–≤–æ–ª—é—Ü–∏–∏","–ü–æ–ª–µ–∂–∞–µ–≤—Å–∫–∞—è","–ü–æ–ª—è–Ω–∫–∞","–ü—Ä–∞–∂—Å–∫–∞—è","–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω—Å–∫–∞—è –ø–ª–æ—â–∞–¥—å",
        "–ü—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–∞—è","–ü—Ä–æ—Å–ø–µ–∫—Ç –í–µ—Ä–Ω–∞–¥—Å–∫–æ–≥–æ","–ü—Ä–æ—Å–ø–µ–∫—Ç –ú–∏—Ä–∞","–ü—Ä–æ—Ñ—Å–æ—é–∑–Ω–∞—è","–ü—É—à–∫–∏–Ω—Å–∫–∞—è","–†–µ—á–Ω–æ–π –≤–æ–∫–∑–∞–ª",
        "–†–∏–∂—Å–∫–∞—è","–†–∏–º—Å–∫–∞—è","–†—è–∑–∞–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç","–°–∞–≤—ë–ª–æ–≤—Å–∫–∞—è","–°–≤–∏–±–ª–æ–≤–æ","–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å—Å–∫–∞—è","–°–µ–º—ë–Ω–æ–≤—Å–∫–∞—è",
        "–°–µ—Ä–ø—É—Ö–æ–≤—Å–∫–∞—è","–°–ª–∞–≤—è–Ω—Å–∫–∏–π –±—É–ª—å–≤–∞—Ä","–°–º–æ–ª–µ–Ω—Å–∫–∞—è","–°–æ–∫–æ–ª","–°–æ–∫–æ–ª—å–Ω–∏–∫–∏","–°–ø–∞—Ä—Ç–∞–∫","–°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è",
        "–°—Ä–µ—Ç–µ–Ω—Å–∫–∏–π –±—É–ª—å–≤–∞—Ä","–°—Ç—Ä–æ–≥–∏–Ω–æ","–°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∞—è","–°—É—Ö–∞—Ä–µ–≤—Å–∫–∞—è","–°—Ö–æ–¥–Ω–µ–Ω—Å–∫–∞—è","–¢–∞–≥–∞–Ω—Å–∫–∞—è","–¢–≤–µ—Ä—Å–∫–∞—è",
        "–¢–µ–∞—Ç—Ä–∞–ª—å–Ω–∞—è","–¢–µ–∫—Å—Ç–∏–ª—å—â–∏–∫–∏","–¢–∏–º–∏—Ä—è–∑–µ–≤—Å–∫–∞—è","–¢—Ä–µ—Ç—å—è–∫–æ–≤—Å–∫–∞—è","–¢—Ä–æ–ø–∞—Ä—ë–≤–æ","–¢—É–ª—å—Å–∫–∞—è","–¢—É—Ä–≥–µ–Ω–µ–≤—Å–∫–∞—è",
        "–¢—É—à–∏–Ω—Å–∫–∞—è","–£–ª–∏—Ü–∞ 1905 –≥–æ–¥–∞","–£–ª–∏—Ü–∞ –ê–∫–∞–¥–µ–º–∏–∫–∞ –Ø–Ω–≥–µ–ª—è","–£–ª–∏—Ü–∞ –ì–æ—Ä—á–∞–∫–æ–≤–∞","–£–ª–∏—Ü–∞ –°–∫–æ–±–µ–ª–µ–≤—Å–∫–∞—è",
        "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç","–§–∏–ª—ë–≤—Å–∫–∏–π –ø–∞—Ä–∫","–§–∏–ª–∏","–§–æ–Ω–≤–∏–∑–∏–Ω—Å–∫–∞—è","–§—Ä—É–Ω–∑–µ–Ω—Å–∫–∞—è","–¶–∞—Ä–∏—Ü—ã–Ω–æ","–¶–≤–µ—Ç–Ω–æ–π –±—É–ª—å–≤–∞—Ä",
        "–ß–µ—Ä–∫–∏–∑–æ–≤—Å–∫–∞—è","–ß–µ—Ä—Ç–∞–Ω–æ–≤—Å–∫–∞—è","–ß–µ—Ö–æ–≤—Å–∫–∞—è","–ß–∏—Å—Ç—ã–µ –ø—Ä—É–¥—ã","–ß–∫–∞–ª–æ–≤—Å–∫–∞—è","–®–∞–±–æ–ª–æ–≤—Å–∫–∞—è","–®–µ–ª–µ–ø–∏—Ö–∞",
        "–©—ë–ª–∫–æ–≤—Å–∫–∞—è","–©—É–∫–∏–Ω—Å–∫–∞—è","–≠–ª–µ–∫—Ç—Ä–æ–∑–∞–≤–æ–¥—Å–∫–∞—è","–Æ–≥–æ-–ó–∞–ø–∞–¥–Ω–∞—è","–Æ–∂–Ω–∞—è","–Ø—Å–µ–Ω–µ–≤–æ"
      ],
      spb: [
        "–ê–¥–º–∏—Ä–∞–ª—Ç–µ–π—Å–∫–∞—è","–ê–≤—Ç–æ–≤–æ","–ë–∞–ª—Ç–∏–π—Å–∫–∞—è","–ë—É—Ö–∞—Ä–µ—Å—Ç—Å–∫–∞—è","–í–∞—Å–∏–ª–µ–æ—Å—Ç—Ä–æ–≤—Å–∫–∞—è","–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è","–í–æ–ª–∫–æ–≤—Å–∫–∞—è",
        "–í—ã–±–æ—Ä–≥—Å–∫–∞—è","–ì–æ—Ä—å–∫–æ–≤—Å–∫–∞—è","–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç","–î–µ–≤—è—Ç–∫–∏–Ω–æ","–î–æ—Å—Ç–æ–µ–≤—Å–∫–∞—è","–î—É–Ω–∞–π—Å–∫–∞—è","–ï–ª–∏–∑–∞—Ä–æ–≤—Å–∫–∞—è",
        "–ó–≤—ë–∑–¥–Ω–∞—è","–ó–µ–Ω–∏—Ç","–ö–æ–º–µ–Ω–¥–∞–Ω—Ç—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç","–ö—Ä–µ—Å—Ç–æ–≤—Å–∫–∏–π –æ—Å—Ç—Ä–æ–≤","–ö—É–ø—á–∏–Ω–æ","–õ–∞–¥–æ–∂—Å–∫–∞—è","–õ–µ–Ω–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç",
        "–õ–µ—Å–Ω–∞—è","–õ–∏–≥–æ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç","–ú–∞—è–∫–æ–≤—Å–∫–∞—è","–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∞—è","–ú–æ—Å–∫–æ–≤—Å–∫–∞—è","–ú–æ—Å–∫–æ–≤—Å–∫–∏–µ –≤–æ—Ä–æ—Ç–∞",
        "–ù–∞—Ä–≤—Å–∫–∞—è","–ù–µ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç","–ù–æ–≤–æ—á–µ—Ä–∫–∞—Å—Å–∫–∞—è","–û–±–≤–æ–¥–Ω—ã–π –∫–∞–Ω–∞–ª","–û–∑–µ—Ä–∫–∏","–ü–∞—Ä–∫ –ü–æ–±–µ–¥—ã","–ü–∞—Ä–Ω–∞—Å",
        "–ü–µ—Ç—Ä–æ–≥—Ä–∞–¥—Å–∫–∞—è","–ü–∏–æ–Ω–µ—Ä—Å–∫–∞—è","–ü–ª–æ—â–∞–¥—å –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –ù–µ–≤—Å–∫–æ–≥–æ","–ü–ª–æ—â–∞–¥—å –í–æ—Å—Å—Ç–∞–Ω–∏—è","–ü–ª–æ—â–∞–¥—å –õ–µ–Ω–∏–Ω–∞",
        "–ü–æ–ª–∏—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è","–ü—Ä–∏–º–æ—Ä—Å–∫–∞—è","–ü—Ä–æ—Å–ø–µ–∫—Ç –ë–æ–ª—å—à–µ–≤–∏–∫–æ–≤","–ü—Ä–æ—Å–ø–µ–∫—Ç –í–µ—Ç–µ—Ä–∞–Ω–æ–≤","–ü—Ä–æ—Å–ø–µ–∫—Ç –ü—Ä–æ—Å–≤–µ—â–µ–Ω–∏—è",
        "–ü—É—à–∫–∏–Ω—Å–∫–∞—è","–†—ã–±–∞—Ü–∫–æ–µ","–°–∞–¥–æ–≤–∞—è","–°–µ–Ω–Ω–∞—è –ø–ª–æ—â–∞–¥—å","–°–ø–∞—Å—Å–∫–∞—è","–°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è","–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç–∏—Ç—É—Ç",
        "–£–¥–µ–ª—å–Ω–∞—è","–§—Ä—É–Ω–∑–µ–Ω—Å–∫–∞—è","–ß—ë—Ä–Ω–∞—è —Ä–µ—á–∫–∞","–ß–∫–∞–ª–æ–≤—Å–∫–∞—è","–≠–ª–µ–∫—Ç—Ä–æ—Å–∏–ª–∞"
      ]
    };

  function updateMetroOptions(city) {
    metroSelect.innerHTML = "";
    metroStations[city].forEach(station => {
      const option = document.createElement("option");
      option.value = station;
      option.textContent = station;
      metroSelect.appendChild(option);
    });
  }

  citySelect.addEventListener("change", () => {
    updateMetroOptions(citySelect.value);
  });

  document.addEventListener("DOMContentLoaded", () => {
    updateMetroOptions(citySelect.value);
  });

  document.getElementById("confirm-btn").addEventListener("click", () => {
    selectedMetro = metroSelect.value;
    modal.style.display = "none";
    loaderText.textContent = `‚è±Ô∏è –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏—Ç—Ä–∏–Ω—ã –¥–ª—è —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ ${selectedMetro}...`;
    loader.style.display = "block";
    let progress = 0;
    const duration = 3000 + Math.random() * 7000;
    const start = Date.now();

    function animateLoader() {
      progress = (Date.now() - start) / duration * 100;
      progressBar.style.width = Math.min(progress, 100) + "%";
      if (progress < 100) {
        requestAnimationFrame(animateLoader);
      } else {
        loader.style.display = "none";
        storeTitle.textContent = `–í–∏—Ç—Ä–∏–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ ${selectedMetro}`;
        renderProducts();
        storefront.style.display = "block";
      }
    }
    animateLoader();
  });

  function renderProducts() {
    productGrid.innerHTML = "";
    for (let i = 0; i < 10; i++) {
      const card = document.createElement("div");
      card.style.background = "#1e1e1e";
      card.style.borderRadius = "10px";
      card.style.padding = "10px";
      card.innerHTML = `
        <img src="https://via.placeholder.com/150" style="width:100%;border-radius:10px;object-fit:cover;margin-bottom:10px;" />
        <h3 style="margin:0 0 5px 0; font-size:14px;">${products[i]}</h3>
        <p style="margin:0 0 5px 0;">–¶–µ–Ω–∞: ${(1000 + i * 100)}‚ÇΩ</p>
        <select class="qty-select" style="width:100%;padding:5px;margin-bottom:5px;background:#333;color:white;border:none;border-radius:5px;">
          <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
        </select>
        <select class="delivery-method" style="width:100%;padding:5px;margin-bottom:5px;background:#333;color:white;border:none;border-radius:5px;">
          <option>–ê–¥—Ä–µ—Å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</option><option>–°–∞–º–æ–≤—ã–≤–æ–∑</option><option>–ü–æ—á—Ç–∞</option>
        </select>
        <button class="buy-btn button">–ö—É–ø–∏—Ç—å</button>
      `;
      productGrid.appendChild(card);
    }
  }

  function showOrderLoader(productName, price, qty, deliveryMethod) {
    savedOrderId = savedOrderId || Math.floor(100000 + Math.random() * 900000);
    const orderLoader = document.getElementById("order-loader");
    const orderText = document.getElementById("order-loader-text");
    const orderProgress = document.getElementById("order-progress-bar");
    orderText.textContent = `üìë –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∑–∞–∫–∞–∑—É #${savedOrderId}...`;
    document.body.classList.add("blurred");
    orderLoader.style.display = "block";
    orderProgress.style.width = "0%";
    const duration = 3000 + Math.random() * 4000;
    const start = Date.now();
    function updateProgress() {
      const percent = Math.min((Date.now() - start) / duration * 100, 100);
      orderProgress.style.width = `${percent}%`;
      if (percent < 100) {
        requestAnimationFrame(updateProgress);
      } else {
        orderLoader.style.display = "none";
        document.body.classList.remove("blurred");
        showPaymentScreen(productName, price, qty, deliveryMethod);
      }
    }
    requestAnimationFrame(updateProgress);
  }

  function showPaymentScreen(name, price, qty, deliveryMethod) {
    const sum = price * qty;
    const card = "1234 5678 9012 3456";
    const timeNow = new Date().toLocaleTimeString();
    const dateNow = new Date().toLocaleDateString();
    paymentScreen.innerHTML = `
      <img src="https://i.ibb.co/0y7cCXgQ/Pay-Banner.png" alt="–ë–∞–Ω–Ω–µ—Ä" style="max-width:100%;height:auto;object-fit:contain;margin-bottom:10px;">
      <p>‚åû–í—Ä–µ–º—è –∏ –¥–∞—Ç–∞: ${timeNow}, ${dateNow}</p>
      <p>‚åûID –∑–∞–∫–∞–∑–∞: ${savedOrderId}</p>
      <p>‚åû–ü–æ–∑–∏—Ü–∏—è: ${name} (${deliveryMethod})</p>
      <p>‚åû–ú–µ—Ç—Ä–æ: ${selectedMetro}</p>
      <br>
      <p><strong>–†–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã:</strong> ${card}</p>
      <p>‚åû–°—É–º–º–∞: ${sum}‚ÇΩ</p>
     
      <p id="timer"></p>
      <button id="check-payment-btn" class="button">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–ø–ª–∞—Ç—É</button>
      <button id="restart-btn" class="button">–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –∑–∞–Ω–æ–≤–æ</button>
      <div id="payment-message"></div>
    `;
    storefront.style.display = "none";
    paymentScreen.style.display = "block";

    const timer = document.getElementById("timer");
    let remaining = 15 * 60;
    setInterval(() => {
      if (remaining > 0) {
        const min = Math.floor(remaining / 60);
        const sec = remaining % 60;
        timer.textContent = `–î–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–ø–ª–∞—Ç—ã: ${min}:${sec.toString().padStart(2, '0')}`;
        remaining--;
      }
    }, 1000);
    
    document.getElementById("check-payment-btn").onclick = () => {
      const messageBox = document.getElementById("payment-message");
      messageBox.innerHTML = `<p>üîé –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ–ø–ª–∞—Ç—ã –ø–æ –∑–∞–∫–∞–∑—É #${savedOrderId}...</p>`;
      const delay = 2000 + Math.random() * 4000;
      setTimeout(() => {
        lastCheckTime = new Date().toLocaleTimeString();
        messageBox.innerHTML = `<div class='yellow-box'>‚ùå –û–ø–ª–∞—Ç–∞ –Ω–∞ —Å—É–º–º—É ${sum}‚ÇΩ –ø–æ —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º ${card} –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–ª–∞—Ç—ë–∂ –ø—Ä–æ–≤–µ–¥—ë–Ω –±–∞–Ω–∫–æ–º –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É —á–µ–∫ –æ–± –æ–ø–ª–∞—Ç–µ. <br><br> –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ${lastCheckTime}</div>`;
      }, delay);
    };
    
    document.getElementById("restart-btn").onclick = () => {
      savedOrderId = null;
      storefront.style.display = "none";
      paymentScreen.style.display = "none";
      modal.style.display = "block";
    };
  }

  document.addEventListener("click", (e) => {
    if (e.target.classList.contains("buy-btn")) {
      const card = e.target.closest("div");
      const name = card.querySelector("h3").textContent;
      const price = parseInt(card.querySelector("p").textContent.match(/\d+/)[0]);
      const qty = parseInt(card.querySelector(".qty-select").value);
      const method = card.querySelector(".delivery-method").value;
      showOrderLoader(name, price, qty, method);
    }
  });
</script>
</body>
</html>
